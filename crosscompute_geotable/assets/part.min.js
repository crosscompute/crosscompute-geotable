function get_geotable_adjective(e){var a="streets|light|dark|satellite|streets-satellite|wheatpaste|streets-basic|comic|outdoors|run-bike-hike|pencil|pirates|emerald|high-contrast".replace(/-/g,"[-_]");try{return RegExp("("+a+")_geotable").exec(e)[1].replace(/_/g,"-")}catch(e){return"streets"}}function draw_map(e,a){for(var t=e+"-map",o=e+"-table",r=L.mapbox.map(t,"mapbox."+get_geotable_adjective(e)),l=[],i=a[0],d=a[1],c=0;c<i.length;c++){var n,s=i[c],p=s[0],u=s[1],_=$.extend({color:"black",weight:2,opacity:.7,fillColor:"yellow",fillOpacity:.5},d,s[2]);switch(p){case 1:n=L.circleMarker(u,_),_.radius_in_pixels&&n.setRadius(+_.radius_in_pixels),add_feature(l,n,c,o);break;case 2:_.color=_.fillColor,add_feature(l,n=L.polyline(u,_),c,o);break;case 3:_.color=_.fillColor;for(var b=0;b<u.length;b++)add_feature(l,n=L.polyline(u[b],_),c,o);break;case 4:add_feature(l,n=L.polygon(u,_),c,o);break;case 5:for(b=0;b<u.length;b++)add_feature(l,n=L.polygon(u[b],_),c,o)}}l.length&&r.fitBounds(L.featureGroup(l).addTo(r).getBounds(),{animate:!1}).on("click",function(){$("#"+o).hide()})}function add_feature(e,a,t,o){a.geotable={table_id:o,tbody_id:o.replace("-table","-row")+t},a.on("click",function(e){var a=this.geotable,t=$("#"+a.tbody_id).show();$("#"+a.table_id+" tbody").not(t).hide(),$("#"+a.table_id).show(),L.DomEvent.stopPropagation(e)}),e.push(a)}$(".geotable-upload").on("uploaded.ir",function(e,a){import_upload(e,a,CC.geotable.import_url,function(e,a){var t=a.find("script").text(),o=$.trim(t.replace(/'/g,'"').replace(/.* = /,"")).slice(0,-1);draw_map(a.attr("id"),$.parseJSON(o))})});
